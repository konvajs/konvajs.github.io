<!DOCTYPE html>
<html lang="en">
  <head prefix="og: http://ogp.me/ns#">
    <meta charset="utf-8" />
<title>
   Text editing in HTML5 canvas with Konva | Konva - JavaScript 2d canvas
  library
</title>
<meta
  name="viewport"
  content="width=device-width, initial-scale=1, maximum-scale=5"
/>
<link rel="canonical" href="https://konvajs.org/docs/sandbox/Editable_Text.html" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff" /> 
<link rel="stylesheet" href="/css/style.css">

<link
  href="//fonts.googleapis.com/css?family=Lato:300,700"
  rel="stylesheet"
  type="text/css"
/>
<link
  href="//fonts.googleapis.com/css?family=Source+Code+Pro:400,700"
  rel="stylesheet"
  type="text/css"
/>
<script
  async
  defer
  data-domain="konvajs.org"
  src="https://plausible.io/js/plausible.js"
></script>
<link rel="alternate" href="/atom.xml" title="Konva.js - JavaScript 2d canvas library"> <meta name="description" content="User can’t directly edit Konva.Text content for many reasons. In fact canvas API is not designed for such purpose.It is possible to emulate text editing on canvas (by drawing blinking cursor, emulate">
<meta property="og:type" content="website">
<meta property="og:title" content="Text editing in HTML5 canvas with Konva">
<meta property="og:url" content="https://konvajs.org/docs/sandbox/Editable_Text.html">
<meta property="og:site_name" content="Konva.js - JavaScript 2d canvas library">
<meta property="og:description" content="User can’t directly edit Konva.Text content for many reasons. In fact canvas API is not designed for such purpose.It is possible to emulate text editing on canvas (by drawing blinking cursor, emulate">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://konvajs.org/logo.png">
<meta property="article:published_time" content="2020-08-04T15:09:27.453Z">
<meta property="article:modified_time" content="2019-08-05T06:48:18.000Z">
<meta property="article:author" content="Anton Lavrenov">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://konvajs.org/logo.png">
<meta name="twitter:site" content="@lavrton"> 

  </head>
  <body>
    <header id="header">
  <div class="outer">
    <div class="inner">
      <div id="logo-wrap">
        <a href="/" id="logo">Konva</a>
        <a id="main-nav-toggle"></a>
      </div>
      <nav id="main-nav">
        <ul id="main-nav-list">
          
          <li class="main-nav-item">
            <a href="/docs/index.html" class="main-nav-link">
              Tutorials
            </a>
          </li>
          
          <li class="main-nav-item">
            <a href="/docs/sandbox/index.html" class="main-nav-link">
              Demos
            </a>
          </li>
          
          <li class="main-nav-item">
            <a href="/api/Konva.html" class="main-nav-link">
              API docs
            </a>
          </li>
          
          <li class="main-nav-item">
            <a href="/docs/react/Intro.html" class="main-nav-link">
              React
            </a>
          </li>
          
          <li class="main-nav-item">
            <a href="/docs/vue/index.html" class="main-nav-link">
              Vue
            </a>
          </li>
          
          <li class="main-nav-item">
            <a href="/docs/svelte/index.html" class="main-nav-link">
              Svelte
            </a>
          </li>
          
          <li class="main-nav-item">
            <a href="/docs/donate.html" class="main-nav-link">
              ❤️ Support Konva
            </a>
          </li>
          
          <li class="main-nav-item">
            <a href="/docs/support.html" class="main-nav-link">
              Need help?
            </a>
          </li>
          
          <li class="main-nav-item">
            <div id="search-container" />
          </li>
          <li class="main-nav-item">
            <a
              href="https://lavrton.com/consulting"
              title="Consulting"
              target="_blank"
              class="main-nav-link"
              style="
                color: white;
                background: #078c34;
                padding: 10px;
                border-radius: 10px;
              "
              >Consulting</a
            >
          </li>
        </ul>

        <a
          href="https://github.com/konvajs/konva"
          id="github-btn"
          title="GitHub"
          target="_blank"
        ></a>
        <a
          href="https://twitter.com/lavrton"
          id="twitter-btn"
          title="Twitter"
          target="_blank"
        ></a>
        <!--
          <a id="search-btn" class="st-search-launcher" title="Search"></a>
        -->
      </nav>
    </div>
  </div>
</header>
 <article class="page" itemscope itemtype="http://schema.org/Article">
  <header id="page-banner">
    <div class="outer">
      <div id="page-banner-inner">
        <h1 id="page-title" itemprop="name">Text editing in HTML5 canvas with Konva</h1>
        <a
          href="https://github.com/konvajs/site/blob/master/source/docs/sandbox/Editable_Text.md"
          title="Improve this doc"
          id="page-edit-link"
        ></a>
      </div>
      <!-- Begin Mailchimp Signup Form -->

<!-- <iframe
  class="mj-w-res-iframe"
  frameborder="0"
  scrolling="no"
  marginheight="0"
  marginwidth="0"
  src="https://app.mailjet.com/widget/iframe/7P23/MU3"
  style="height: 70px; margin: auto; width: 450px"
></iframe> -->

<!-- <script
  type="text/javascript"
  src="https://app.mailjet.com/statics/js/iframeResizer.min.js"
></script> -->

<!--End mc_embed_signup-->

    </div>
  </header>

  <div class="outer">
    <div id="mobile-menu-wrap"></div>
    <aside id="sidebar">
  
    <strong class="sidebar-title">
      CAD Systems
    </strong>
    
      <a href="/docs/sandbox/Canvas_Editor.html" class="sidebar-link">
        Canvas Editor
      </a>
      
      <a href="/docs/sandbox/Simple_Window_Frame.html" class="sidebar-link">
        Simple Window Frame
      </a>
      
      <a href="/docs/sandbox/Window_Frame_Designer.html" class="sidebar-link">
        Window Frame Designer
      </a>
      
      <a href="/docs/sandbox/Seats_Reservation.html" class="sidebar-link">
        Seats Reservation
      </a>
      
      <a href="/docs/sandbox/Image_Labeling.html" class="sidebar-link">
        Drawing Labels on Image
      </a>
      
      <a href="/docs/sandbox/Interactive_Building_Map.html" class="sidebar-link">
        Interactive Building Map
      </a>
      
        
    <strong class="sidebar-title">
      Games and Apps
    </strong>
    
      <a href="/docs/sandbox/Wheel_of_Fortune.html" class="sidebar-link">
        Wheel of Fortune
      </a>
      
      <a href="/docs/sandbox/Free_Drawing.html" class="sidebar-link">
        Free Drawing
      </a>
      
      <a href="/docs/sandbox/Animals_on_the_Beach_Game.html" class="sidebar-link">
        Animals on the Beach Game
      </a>
      
      <a href="/docs/sandbox/Planets_Image_Map.html" class="sidebar-link">
        Planets Image Map
      </a>
      
      <a href="/docs/sandbox/Physics_Simulator.html" class="sidebar-link">
        Physics Simulator
      </a>
      
        
    <strong class="sidebar-title">
      Common use cases
    </strong>
    
      <a href="/docs/sandbox/Editable_Text.html" class="sidebar-link current">
        Editable Text
      </a>
      
      <a href="/docs/sandbox/Rich_Text.html" class="sidebar-link">
        Rich Text rendering
      </a>
      
      <a href="/docs/sandbox/Canvas_Scrolling.html" class="sidebar-link">
        Canvas Scrolling
      </a>
      
      <a href="/docs/sandbox/GIF_On_Canvas.html" class="sidebar-link">
        Gif Animation
      </a>
      
      <a href="/docs/sandbox/Video_On_Canvas.html" class="sidebar-link">
        Display Video
      </a>
      
      <a href="/docs/sandbox/SVG_On_Canvas.html" class="sidebar-link">
        SVG on Canvas
      </a>
      
      <a href="/docs/sandbox/Canvas_Background.html" class="sidebar-link">
        Canvas Background
      </a>
      
      <a href="/docs/sandbox/Transparent_Group.html" class="sidebar-link">
        Transparent Group
      </a>
      
      <a href="/docs/sandbox/Mirror_Canvas_Shape.html" class="sidebar-link">
        Mirror/Flip Shape
      </a>
      
      <a href="/docs/sandbox/Canvas_to_PDF.html" class="sidebar-link">
        Canvas to PDF
      </a>
      
      <a href="/docs/sandbox/Custom_Font.html" class="sidebar-link">
        Custom Font
      </a>
      
      <a href="/docs/sandbox/Relative_Pointer_Position.html" class="sidebar-link">
        Relative Pointer Position
      </a>
      
      <a href="/docs/sandbox/Drop_DOM_Element.html" class="sidebar-link">
        Drop DOM Element
      </a>
      
      <a href="/docs/sandbox/Objects_Snapping.html" class="sidebar-link">
        Objects Snapping
      </a>
      
      <a href="/docs/sandbox/Zooming_Relative_To_Pointer.html" class="sidebar-link">
        Zoom Relative To Pointer
      </a>
      
      <a href="/docs/sandbox/Canvas_Context_Menu.html" class="sidebar-link">
        Context Menu
      </a>
      
      <a href="/docs/sandbox/Scale_Image_To_Fit.html" class="sidebar-link">
        Image Scale To Fit
      </a>
      
      <a href="/docs/sandbox/Limited_Drag_And_Resize.html" class="sidebar-link">
        Limit Resize and Drag
      </a>
      
        
    <strong class="sidebar-title">
      Performance tests
    </strong>
    
      <a href="/docs/sandbox/Drag_and_Drop_Stress_Test.html" class="sidebar-link">
        Drag and Drop Stress Test
      </a>
      
      <a href="/docs/sandbox/Animation_Stress_Test.html" class="sidebar-link">
        Animation Stress Test
      </a>
      
      <a href="/docs/sandbox/Jumping_Bunnies.html" class="sidebar-link">
        Bunnies Stress Test
      </a>
      
      <a href="/docs/sandbox/10000_Shapes_with_Tooltip.html" class="sidebar-link">
        10000 Shapes with Tooltip
      </a>
      
      <a href="/docs/sandbox/20000_Nodes.html" class="sidebar-link">
        20000 Nodes
      </a>
      
      <a href="/docs/sandbox/Resizing_Stress_Test.html" class="sidebar-link">
        Resizing Stress Test
      </a>
      
      <a href="/docs/sandbox/Quantum_Squiggle.html" class="sidebar-link">
        Quantum Squiggle
      </a>
      
        
    <strong class="sidebar-title">
      Other random demos
    </strong>
    
      <a href="/docs/sandbox/Web_Worker.html" class="sidebar-link">
        Web Worker
      </a>
      
      <a href="/docs/sandbox/Star_Spinner.html" class="sidebar-link">
        Star Spinner
      </a>
      
      <a href="/docs/sandbox/Connected_Objects.html" class="sidebar-link">
        Connected Objects
      </a>
      
      <a href="/docs/sandbox/Image_Resize.html" class="sidebar-link">
        Manual Image Resize
      </a>
      
      <a href="/docs/sandbox/Stage_Preview.html" class="sidebar-link">
        Stage Preview
      </a>
      
      <a href="/docs/sandbox/Modify_Curves_with_Anchor_Points.html" class="sidebar-link">
        Modify Curves with Anchor Points
      </a>
      
      <a href="/docs/sandbox/Image_Border.html" class="sidebar-link">
        Image Border
      </a>
      
      <a href="/docs/sandbox/Collision_Detection.html" class="sidebar-link">
        Collision Detection
      </a>
      
      <a href="/docs/sandbox/Elastic_Stars.html" class="sidebar-link">
        Elastic Stars
      </a>
      
      <a href="/docs/sandbox/Shape_Tango.html" class="sidebar-link">
        Shape Tango
      </a>
      
      <a href="/docs/sandbox/Image_Border_Highlighting.html" class="sidebar-link">
        Image Border Highlighting
      </a>
      
      <a href="/docs/sandbox/Zoom_Layer_On_hover.html" class="sidebar-link">
        Zoom Layer On hover
      </a>
      
      <a href="/docs/sandbox/Responsive_Canvas.html" class="sidebar-link">
        Responsive Canvas Stage
      </a>
      
      <a href="/docs/sandbox/Gestures.html" class="sidebar-link">
        Touch Gestures
      </a>
      
      <a href="/docs/sandbox/Multi-touch_Scale_Shape.html" class="sidebar-link">
        Multi-touch Scale Shape
      </a>
      
      <a href="/docs/sandbox/Multi-touch_Scale_Stage.html" class="sidebar-link">
        Multi-touch Scale Stage
      </a>
      
      <a href="/docs/sandbox/Modify_Shape_Color_on_Click.html" class="sidebar-link">
        Modify Shape Color on Click
      </a>
      
      <a href="/docs/sandbox/Expand_Images_on_Hover.html" class="sidebar-link">
        Expand Images on Hover
      </a>
      
      <a href="/docs/sandbox/Shape_Tooltips.html" class="sidebar-link">
        Shape Tooltip
      </a>
      
      <a href="/docs/sandbox/Drag_and_Drop_Multiple_Shapes.html" class="sidebar-link">
        Drag and Drop Multiple Shapes
      </a>
      
        
</aside>
    <div class="page-content">
      <!--<div class="toc-wrap">-->
      <!--<strong class="toc-title">Contents</strong>-->
      <!---->
      <!--</div>-->
      <div class="page-entry" itemprop="articleBody">
        <p>User can’t directly edit <code>Konva.Text</code> content for <a href="https://www.w3.org/TR/2dcontext/#best-practices" target="_blank" rel="noopener">many reasons</a>. In fact canvas API is not designed for such purpose.<br>It is possible to emulate text editing on canvas (by drawing blinking cursor, emulate selection, etc).<br>Konva has not support for such case. We recommend to edit the user input outside of your canvas with native DOM elements such as <code>input</code> or <code>textarea</code>.</p>
<p>Here we will create two demos. Basic demo for general understanding of the technic. And the more complex one, used in real-word app that cover more edge cases.</p>
<p>If you want to enable full rich text editing features see <a href="/docs/sandbox/Rich_Text.html">Rich Text Demo</a>.</p>
<p>Instructions: Double click on text to edit it. Type something. Press Enter.</p>
<p>Simple demo:</p>
<iframe src="/downloads/code/sandbox/Editable_Text.html" width="100%" height="300" frameborder="0" loading="lazy" allowfullscreen></iframe>

<details><summary>Show source code of simple demo!</summary>
<p>
<figure class="highlight html"><figcaption><span>Konva Editable text Demo</span><a href="/downloads/code/sandbox/Editable_Text.html">view raw</a></figcaption><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://unpkg.com/konva@9.2.3/konva.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Konva Editable Text on html5 canvas Demo<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">      body {</span><br><span class="line">        margin: 0;</span><br><span class="line">        padding: 0;</span><br><span class="line">        overflow: hidden;</span><br><span class="line"><span class="css">        <span class="selector-tag">background-color</span>: <span class="selector-id">#f0f0f0</span>;</span></span><br><span class="line">      }</span><br><span class="line">    <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"container"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> width = <span class="built_in">window</span>.innerWidth;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> height = <span class="built_in">window</span>.innerHeight;</span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">      <span class="keyword">var</span> stage = <span class="keyword">new</span> Konva.Stage({</span></span><br><span class="line"><span class="actionscript">        container: <span class="string">'container'</span>,</span></span><br><span class="line">        width: width,</span><br><span class="line">        height: height,</span><br><span class="line">      });</span><br><span class="line"></span><br><span class="line"><span class="actionscript">      <span class="keyword">var</span> layer = <span class="keyword">new</span> Konva.Layer();</span></span><br><span class="line">      stage.add(layer);</span><br><span class="line"></span><br><span class="line"><span class="actionscript">      <span class="keyword">var</span> textNode = <span class="keyword">new</span> Konva.Text({</span></span><br><span class="line"><span class="actionscript">        text: <span class="string">'Some text here'</span>,</span></span><br><span class="line">        x: 50,</span><br><span class="line">        y: 50,</span><br><span class="line">        fontSize: 20,</span><br><span class="line">      });</span><br><span class="line"></span><br><span class="line">      layer.add(textNode);</span><br><span class="line"></span><br><span class="line"><span class="actionscript">      textNode.on(<span class="string">'dblclick dbltap'</span>, () =&gt; {</span></span><br><span class="line"><span class="actionscript">        <span class="comment">// create textarea over canvas with absolute position</span></span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">        <span class="comment">// first we need to find position for textarea</span></span></span><br><span class="line"><span class="actionscript">        <span class="comment">// how to find it?</span></span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">        <span class="comment">// at first lets find position of text node relative to the stage:</span></span></span><br><span class="line"><span class="actionscript">        <span class="keyword">var</span> textPosition = textNode.getAbsolutePosition();</span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">        <span class="comment">// then lets find position of stage container on the page:</span></span></span><br><span class="line"><span class="actionscript">        <span class="keyword">var</span> stageBox = stage.container().getBoundingClientRect();</span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">        <span class="comment">// so position of textarea will be the sum of positions above:</span></span></span><br><span class="line"><span class="actionscript">        <span class="keyword">var</span> areaPosition = {</span></span><br><span class="line">          x: stageBox.left + textPosition.x,</span><br><span class="line">          y: stageBox.top + textPosition.y,</span><br><span class="line">        };</span><br><span class="line"></span><br><span class="line"><span class="actionscript">        <span class="comment">// create textarea and style it</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> textarea = <span class="built_in">document</span>.createElement(<span class="string">'textarea'</span>);</span></span><br><span class="line"><span class="javascript">        <span class="built_in">document</span>.body.appendChild(textarea);</span></span><br><span class="line"></span><br><span class="line">        textarea.value = textNode.text();</span><br><span class="line"><span class="actionscript">        textarea.style.position = <span class="string">'absolute'</span>;</span></span><br><span class="line"><span class="actionscript">        textarea.style.top = areaPosition.y + <span class="string">'px'</span>;</span></span><br><span class="line"><span class="actionscript">        textarea.style.left = areaPosition.x + <span class="string">'px'</span>;</span></span><br><span class="line">        textarea.style.width = textNode.width();</span><br><span class="line"></span><br><span class="line">        textarea.focus();</span><br><span class="line"></span><br><span class="line"><span class="actionscript">        textarea.addEventListener(<span class="string">'keydown'</span>, <span class="function"><span class="keyword">function</span> <span class="params">(e)</span> </span>{</span></span><br><span class="line"><span class="actionscript">          <span class="comment">// hide on enter</span></span></span><br><span class="line">          if (e.keyCode === 13) {</span><br><span class="line">            textNode.text(textarea.value);</span><br><span class="line"><span class="javascript">            <span class="built_in">document</span>.body.removeChild(textarea);</span></span><br><span class="line">          }</span><br><span class="line">        });</span><br><span class="line">      });</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
</p>
</details>

<p>Complex demo:</p>
<iframe src="/downloads/code/sandbox/Complex_Editable_Text.html" width="100%" height="300" frameborder="0" loading="lazy" allowfullscreen></iframe>

<details><summary>Show source code of complex demo!</summary>
<p>
<figure class="highlight html"><figcaption><span>Canvas Complex Text Demo</span><a href="/downloads/code/sandbox/Complex_Editable_Text.html">view raw</a></figcaption><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://unpkg.com/konva@9.2.3/konva.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Konva Editable Text on html5 canvas Demo<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">      body {</span><br><span class="line">        margin: 0;</span><br><span class="line">        padding: 0;</span><br><span class="line"><span class="css">        <span class="selector-tag">background-color</span>: <span class="selector-id">#f0f0f0</span>;</span></span><br><span class="line">      }</span><br><span class="line">    <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"container"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> width = <span class="built_in">window</span>.innerWidth;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> height = <span class="built_in">window</span>.innerHeight;</span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">      <span class="keyword">var</span> stage = <span class="keyword">new</span> Konva.Stage({</span></span><br><span class="line"><span class="actionscript">        container: <span class="string">'container'</span>,</span></span><br><span class="line">        width: width,</span><br><span class="line">        height: height,</span><br><span class="line">      });</span><br><span class="line"></span><br><span class="line"><span class="actionscript">      <span class="keyword">var</span> layer = <span class="keyword">new</span> Konva.Layer();</span></span><br><span class="line">      stage.add(layer);</span><br><span class="line"></span><br><span class="line"><span class="actionscript">      <span class="keyword">var</span> textNode = <span class="keyword">new</span> Konva.Text({</span></span><br><span class="line"><span class="actionscript">        text: <span class="string">'Some text here'</span>,</span></span><br><span class="line">        x: 50,</span><br><span class="line">        y: 80,</span><br><span class="line">        fontSize: 20,</span><br><span class="line"><span class="actionscript">        draggable: <span class="literal">true</span>,</span></span><br><span class="line">        width: 200,</span><br><span class="line">      });</span><br><span class="line"></span><br><span class="line">      layer.add(textNode);</span><br><span class="line"></span><br><span class="line"><span class="actionscript">      <span class="keyword">var</span> tr = <span class="keyword">new</span> Konva.Transformer({</span></span><br><span class="line">        node: textNode,</span><br><span class="line"><span class="actionscript">        enabledAnchors: [<span class="string">'middle-left'</span>, <span class="string">'middle-right'</span>],</span></span><br><span class="line"><span class="actionscript">        <span class="comment">// set minimum width of text</span></span></span><br><span class="line"><span class="actionscript">        boundBoxFunc: <span class="function"><span class="keyword">function</span> <span class="params">(oldBox, newBox)</span> </span>{</span></span><br><span class="line"><span class="javascript">          newBox.width = <span class="built_in">Math</span>.max(<span class="number">30</span>, newBox.width);</span></span><br><span class="line"><span class="actionscript">          <span class="keyword">return</span> newBox;</span></span><br><span class="line">        },</span><br><span class="line">      });</span><br><span class="line"></span><br><span class="line"><span class="actionscript">      textNode.on(<span class="string">'transform'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>{</span></span><br><span class="line"><span class="actionscript">        <span class="comment">// reset scale, so only with is changing by transformer</span></span></span><br><span class="line">        textNode.setAttrs({</span><br><span class="line">          width: textNode.width() * textNode.scaleX(),</span><br><span class="line">          scaleX: 1,</span><br><span class="line">        });</span><br><span class="line">      });</span><br><span class="line"></span><br><span class="line">      layer.add(tr);</span><br><span class="line"></span><br><span class="line"><span class="actionscript">      textNode.on(<span class="string">'dblclick dbltap'</span>, () =&gt; {</span></span><br><span class="line"><span class="actionscript">        <span class="comment">// hide text node and transformer:</span></span></span><br><span class="line">        textNode.hide();</span><br><span class="line">        tr.hide();</span><br><span class="line"></span><br><span class="line"><span class="actionscript">        <span class="comment">// create textarea over canvas with absolute position</span></span></span><br><span class="line"><span class="actionscript">        <span class="comment">// first we need to find position for textarea</span></span></span><br><span class="line"><span class="actionscript">        <span class="comment">// how to find it?</span></span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">        <span class="comment">// at first lets find position of text node relative to the stage:</span></span></span><br><span class="line"><span class="actionscript">        <span class="keyword">var</span> textPosition = textNode.absolutePosition();</span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">        <span class="comment">// so position of textarea will be the sum of positions above:</span></span></span><br><span class="line"><span class="actionscript">        <span class="keyword">var</span> areaPosition = {</span></span><br><span class="line">          x: stage.container().offsetLeft + textPosition.x,</span><br><span class="line">          y: stage.container().offsetTop + textPosition.y,</span><br><span class="line">        };</span><br><span class="line"></span><br><span class="line"><span class="actionscript">        <span class="comment">// create textarea and style it</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> textarea = <span class="built_in">document</span>.createElement(<span class="string">'textarea'</span>);</span></span><br><span class="line"><span class="javascript">        <span class="built_in">document</span>.body.appendChild(textarea);</span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">        <span class="comment">// apply many styles to match text on canvas as close as possible</span></span></span><br><span class="line"><span class="actionscript">        <span class="comment">// remember that text rendering on canvas and on the textarea can be different</span></span></span><br><span class="line"><span class="actionscript">        <span class="comment">// and sometimes it is hard to make it 100% the same. But we will try...</span></span></span><br><span class="line">        textarea.value = textNode.text();</span><br><span class="line"><span class="actionscript">        textarea.style.position = <span class="string">'absolute'</span>;</span></span><br><span class="line"><span class="actionscript">        textarea.style.top = areaPosition.y + <span class="string">'px'</span>;</span></span><br><span class="line"><span class="actionscript">        textarea.style.left = areaPosition.x + <span class="string">'px'</span>;</span></span><br><span class="line"><span class="actionscript">        textarea.style.width = textNode.width() - textNode.padding() * <span class="number">2</span> + <span class="string">'px'</span>;</span></span><br><span class="line">        textarea.style.height =</span><br><span class="line"><span class="actionscript">          textNode.height() - textNode.padding() * <span class="number">2</span> + <span class="number">5</span> + <span class="string">'px'</span>;</span></span><br><span class="line"><span class="actionscript">        textarea.style.fontSize = textNode.fontSize() + <span class="string">'px'</span>;</span></span><br><span class="line"><span class="actionscript">        textarea.style.border = <span class="string">'none'</span>;</span></span><br><span class="line"><span class="actionscript">        textarea.style.padding = <span class="string">'0px'</span>;</span></span><br><span class="line"><span class="actionscript">        textarea.style.margin = <span class="string">'0px'</span>;</span></span><br><span class="line"><span class="actionscript">        textarea.style.overflow = <span class="string">'hidden'</span>;</span></span><br><span class="line"><span class="actionscript">        textarea.style.background = <span class="string">'none'</span>;</span></span><br><span class="line"><span class="actionscript">        textarea.style.outline = <span class="string">'none'</span>;</span></span><br><span class="line"><span class="actionscript">        textarea.style.resize = <span class="string">'none'</span>;</span></span><br><span class="line">        textarea.style.lineHeight = textNode.lineHeight();</span><br><span class="line">        textarea.style.fontFamily = textNode.fontFamily();</span><br><span class="line"><span class="actionscript">        textarea.style.transformOrigin = <span class="string">'left top'</span>;</span></span><br><span class="line">        textarea.style.textAlign = textNode.align();</span><br><span class="line">        textarea.style.color = textNode.fill();</span><br><span class="line">        rotation = textNode.rotation();</span><br><span class="line"><span class="actionscript">        <span class="keyword">var</span> transform = <span class="string">''</span>;</span></span><br><span class="line">        if (rotation) {</span><br><span class="line"><span class="actionscript">          transform += <span class="string">'rotateZ('</span> + rotation + <span class="string">'deg)'</span>;</span></span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line"><span class="actionscript">        <span class="keyword">var</span> px = <span class="number">0</span>;</span></span><br><span class="line"><span class="actionscript">        <span class="comment">// also we need to slightly move textarea on firefox</span></span></span><br><span class="line"><span class="actionscript">        <span class="comment">// because it jumps a bit</span></span></span><br><span class="line"><span class="actionscript">        <span class="keyword">var</span> isFirefox =</span></span><br><span class="line"><span class="actionscript">          navigator.userAgent.toLowerCase().indexOf(<span class="string">'firefox'</span>) &gt; <span class="number">-1</span>;</span></span><br><span class="line">        if (isFirefox) {</span><br><span class="line"><span class="javascript">          px += <span class="number">2</span> + <span class="built_in">Math</span>.round(textNode.fontSize() / <span class="number">20</span>);</span></span><br><span class="line">        }</span><br><span class="line"><span class="actionscript">        transform += <span class="string">'translateY(-'</span> + px + <span class="string">'px)'</span>;</span></span><br><span class="line"></span><br><span class="line">        textarea.style.transform = transform;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">        <span class="comment">// reset height</span></span></span><br><span class="line"><span class="actionscript">        textarea.style.height = <span class="string">'auto'</span>;</span></span><br><span class="line"><span class="actionscript">        <span class="comment">// after browsers resized it we can set actual value</span></span></span><br><span class="line"><span class="actionscript">        textarea.style.height = textarea.scrollHeight + <span class="number">3</span> + <span class="string">'px'</span>;</span></span><br><span class="line"></span><br><span class="line">        textarea.focus();</span><br><span class="line"></span><br><span class="line"><span class="actionscript">        <span class="function"><span class="keyword">function</span> <span class="title">removeTextarea</span><span class="params">()</span> </span>{</span></span><br><span class="line">          textarea.parentNode.removeChild(textarea);</span><br><span class="line"><span class="javascript">          <span class="built_in">window</span>.removeEventListener(<span class="string">'click'</span>, handleOutsideClick);</span></span><br><span class="line">          textNode.show();</span><br><span class="line">          tr.show();</span><br><span class="line">          tr.forceUpdate();</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line"><span class="actionscript">        <span class="function"><span class="keyword">function</span> <span class="title">setTextareaWidth</span><span class="params">(newWidth)</span> </span>{</span></span><br><span class="line">          if (!newWidth) {</span><br><span class="line"><span class="actionscript">            <span class="comment">// set width for placeholder</span></span></span><br><span class="line">            newWidth = textNode.placeholder.length * textNode.fontSize();</span><br><span class="line">          }</span><br><span class="line"><span class="actionscript">          <span class="comment">// some extra fixes on different browsers</span></span></span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> isSafari = <span class="regexp">/^((?!chrome|android).)*safari/i</span>.test(</span></span><br><span class="line">            navigator.userAgent</span><br><span class="line">          );</span><br><span class="line"><span class="actionscript">          <span class="keyword">var</span> isFirefox =</span></span><br><span class="line"><span class="actionscript">            navigator.userAgent.toLowerCase().indexOf(<span class="string">'firefox'</span>) &gt; <span class="number">-1</span>;</span></span><br><span class="line">          if (isSafari || isFirefox) {</span><br><span class="line"><span class="javascript">            newWidth = <span class="built_in">Math</span>.ceil(newWidth);</span></span><br><span class="line">          }</span><br><span class="line"></span><br><span class="line"><span class="actionscript">          <span class="keyword">var</span> isEdge =</span></span><br><span class="line"><span class="javascript">            <span class="built_in">document</span>.documentMode || <span class="regexp">/Edge/</span>.test(navigator.userAgent);</span></span><br><span class="line">          if (isEdge) {</span><br><span class="line">            newWidth += 1;</span><br><span class="line">          }</span><br><span class="line"><span class="actionscript">          textarea.style.width = newWidth + <span class="string">'px'</span>;</span></span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line"><span class="actionscript">        textarea.addEventListener(<span class="string">'keydown'</span>, <span class="function"><span class="keyword">function</span> <span class="params">(e)</span> </span>{</span></span><br><span class="line"><span class="actionscript">          <span class="comment">// hide on enter</span></span></span><br><span class="line"><span class="actionscript">          <span class="comment">// but don't hide on shift + enter</span></span></span><br><span class="line">          if (e.keyCode === 13 &amp;&amp; !e.shiftKey) {</span><br><span class="line">            textNode.text(textarea.value);</span><br><span class="line">            removeTextarea();</span><br><span class="line">          }</span><br><span class="line"><span class="actionscript">          <span class="comment">// on esc do not set value back to node</span></span></span><br><span class="line">          if (e.keyCode === 27) {</span><br><span class="line">            removeTextarea();</span><br><span class="line">          }</span><br><span class="line">        });</span><br><span class="line"></span><br><span class="line"><span class="actionscript">        textarea.addEventListener(<span class="string">'keydown'</span>, <span class="function"><span class="keyword">function</span> <span class="params">(e)</span> </span>{</span></span><br><span class="line">          scale = textNode.getAbsoluteScale().x;</span><br><span class="line">          setTextareaWidth(textNode.width() * scale);</span><br><span class="line"><span class="actionscript">          textarea.style.height = <span class="string">'auto'</span>;</span></span><br><span class="line">          textarea.style.height =</span><br><span class="line"><span class="actionscript">            textarea.scrollHeight + textNode.fontSize() + <span class="string">'px'</span>;</span></span><br><span class="line">        });</span><br><span class="line"></span><br><span class="line"><span class="actionscript">        <span class="function"><span class="keyword">function</span> <span class="title">handleOutsideClick</span><span class="params">(e)</span> </span>{</span></span><br><span class="line">          if (e.target !== textarea) {</span><br><span class="line">            textNode.text(textarea.value);</span><br><span class="line">            removeTextarea();</span><br><span class="line">          }</span><br><span class="line">        }</span><br><span class="line"><span class="javascript">        setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> {</span></span><br><span class="line"><span class="javascript">          <span class="built_in">window</span>.addEventListener(<span class="string">'click'</span>, handleOutsideClick);</span></span><br><span class="line">        });</span><br><span class="line">      });</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
</p>
</details>
      </div>
      <footer id="page-footer">
        <a href="/docs/index.html" id="page-footer-next" title="Intro">Next</a>
      </footer>
      <div style="padding: 30px; font-size: 18px; text-align: center; color: grey">
  Enjoying Konva? Please consider to
  <a href="/docs/donate.html">support</a> the project.
</div>

<section id="comments" style="margin-top: 50px">
  <div id="disqus_thread">
    <noscript
      >Please enable JavaScript to view the
      <a href="//disqus.com/?ref_noscript"
        >comments powered by Disqus.</a
      ></noscript
    >
  </div>
</section>


    </div>
  </div>
</article>
 <footer id="footer">
  <div class="outer">
      <div class="inner">
          <!-- Begin Mailchimp Signup Form -->

<!-- <iframe
  class="mj-w-res-iframe"
  frameborder="0"
  scrolling="no"
  marginheight="0"
  marginwidth="0"
  src="https://app.mailjet.com/widget/iframe/7P23/MU3"
  style="height: 70px; margin: auto; width: 450px"
></iframe> -->

<!-- <script
  type="text/javascript"
  src="https://app.mailjet.com/statics/js/iframeResizer.min.js"
></script> -->

<!--End mc_embed_signup-->

        </div>
    <div class="inner">
      <div class="footer-resources">
        <h3>Docs</h3>
        <ul>
          <li><a href="/docs">Tutorials</a></li>
          <li><a href="/docs/overview.html">General Overview</a></li>
          <li><a href="/api/Konva.html">API doc</a></li>

          <li><a href="/docs/sandbox/index.html">Demos</a></li>
          <li><a href="/docs/react/index.html">Usage with React</a></li>
          <li><a href="/docs/vue/index.html">Usage with Vue</a></li>
          <li>
            <a href="https://github.com/konvajs/konva/blob/master/CHANGELOG.md"
              >Changelog</a
            >
          </li>
        </ul>
      </div>
      <div class="footer-resources">
        <h3>CHANNELS</h3>
        <ul>
          <li>
            <a href="https://github.com/konvajs/konva" target="_blank"
              >GitHub</a
            >
          </li>
          <li>
            <a
              href="https://stackoverflow.com/questions/tagged/konvajs"
              target="_blank"
              >StackOverflow</a
            >
          </li>
          <li><a href="https://discord.gg/8FqZwVT" target="_blank">Discord chat</a></li>
          <li>
            <a href="https://github.com/konvajs/konva/blob/master/CHANGELOG.md" target="_blank"
              >Changelog</a
            >
          </li>
        </ul>
        
      </div>
      <div class="footer-resources">
          <h3>More</h3>
          <ul>
            <li>
              <a href="/docs/support.html"
                >Need help?</a
              >
            </li>
            <li>
              <a
                href="/docs/donate.html"
                target="_blank"
                >Donate</a>
            </li>
            <li>
              <a
                href="https://polotno.com/"
                target="_blank"
                >Design Editor SDK</a>
            </li>
          </ul>
    </div>
    <div class="inner">
        <div id="footer-copyright">
            &copy; 2023 KonvaJS<br />
          </div>
      <div id="footer-links">
        <a
          href="https://twitter.com/lavrton"
          id="footer-link-twitter"
          class="footer-link"
          target="_blank"
          ><span>Twitter</span></a
        >
        <a
          href="https://github.com/konvajs/konva"
          id="footer-link-github"
          class="footer-link"
          target="_blank"
          ><span>GitHub</span></a
        >
      </div>
    </div>
  
  </div>

  <a class="chat-button" href="https://discord.gg/8FqZwVT" target="_blank" rel="noopener">Join discord chat</a>
  
  <!-- <iframe src="https://discord.com/widget?id=753274212814422176&theme=dark" width="350" height="500" allowtransparency="true" frameborder="0" sandbox="allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts"></iframe> -->
 
</footer>
 
<!-- Disqus -->
<script>
  var disqus_shortname = 'konvajs';
  
  var disqus_url = 'https://konvajs.org/docs/sandbox/Editable_Text.html';
  
    (function () {
      var dsq = document.createElement('script');
      dsq.type = 'text/javascript';
      dsq.async = true;
      dsq.defer = true;
      dsq.src = '//go.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>


<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/@docsearch/css@alpha"
/>
<script
  type="text/javascript"
  src="https://cdn.jsdelivr.net/npm/@docsearch/js@alpha"
></script>
<script type="text/javascript">
  docsearch({
    apiKey: '79bc02f9230d7d4c985e6f543a0a6427',
    appId: '8J5ZKQ6RXR',
    indexName: 'konvajs',
    container: '#search-container',
    algoliaOptions: {
      hitsPerPage: 10,
      // See https://www.algolia.com/doc/api-reference/api-parameters/
    },
    // transformData: function (suggestions) {
    //   // Transform the list of suggestions, and the return the updated list
    //   suggestions.sort(function (a, b) {
    //     if (a.url.indexOf('/api/') >= 0) {
    //       return 1;
    //     } else {
    //       return -1;
    //     }
    //   });
    //   return suggestions.slice(0, 10);
    // },
    debug: false, // Set debug to true if you want to inspect the dropdown
  });
</script>
<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

<script src="/js/retina.min.js"></script>
 
<script src="/js/script.js"></script>

<!-- Google+ -->
<!-- <script type="text/javascript" src="//apis.google.com/js/plusone.js"></script> -->
<!-- Twitter -->
<!-- <script>
  !(function(d, s, id) {
    var js,
      fjs = d.getElementsByTagName(s)[0],
      p = /^http:/.test(d.location) ? 'http' : 'https';
    if (!d.getElementById(id)) {
      js = d.createElement(s);
      js.id = id;
      js.src = p + '://platform.twitter.com/widgets.js';
      fjs.parentNode.insertBefore(js, fjs);
    }
  })(document, 'script', 'twitter-wjs');
</script> -->

  </body>
</html>
